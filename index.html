<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MCPE OS v12 - Neon Blue</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;800&family=Rajdhani:wght@700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    
    <style>
        :root {
            --neon: #00f2ff;
            --bg: #000814; /* Xanh bi·ªÉn c·ª±c t·ªëi */
            --surface: #001d3d; /* Xanh bi·ªÉn s√¢u */
            --text: #e0fbff;
            --border: #003566;
            --chess-w: #003566;
            --chess-b: #000814;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; }
        body { background: var(--bg); color: var(--text); overflow: hidden; height: 100vh; }

        /* --- INTRO LOAD --- */
        #splash {
            position: fixed; inset: 0; background: var(--bg); z-index: 10000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .loader { width: 100px; height: 100px; border: 3px solid var(--border); border-top: 3px solid var(--neon); border-radius: 50%; animation: spin 1s linear infinite; box-shadow: 0 0 15px var(--neon); }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- LAYOUT --- */
        .os-wrapper { max-width: 480px; margin: 0 auto; height: 100vh; display: flex; flex-direction: column; border: 1px solid var(--border); background: linear-gradient(180deg, #000814 0%, #001d3d 100%); }
        header { padding: 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .main-content { flex: 1; overflow-y: auto; padding: 20px 20px 100px; }

        /* --- CHESS UI --- */
        .win { position: fixed; inset: 0; background: var(--bg); z-index: 5000; display: none; flex-direction: column; }
        .win-head { padding: 15px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: var(--surface); }
        
        /* Menu ch·ªçn ƒë·ªô kh√≥ tr∆∞·ªõc khi ch∆°i */
        #chess-setup { position: absolute; inset: 0; background: rgba(0,8,20,0.95); z-index: 5001; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; }
        
        #chess-board { display: grid; grid-template-columns: repeat(8, 1fr); width: 100%; max-width: 380px; aspect-ratio: 1/1; border: 2px solid var(--neon); margin: 10px auto; position: relative; }
        .cell { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }
        .cell.light { background: var(--chess-w); }
        .cell.dark { background: var(--chess-b); }
        .piece { width: 90%; height: 90%; background-size: contain; background-repeat: no-repeat; background-position: center; filter: drop-shadow(0 0 5px var(--neon)); }
        .selected { background: rgba(0, 242, 255, 0.3) !important; }
        .hint::after { content: ""; width: 25%; height: 25%; background: var(--neon); border-radius: 50%; box-shadow: 0 0 10px var(--neon); }

        /* Th√¥ng b√°o Checkmate/Chi·∫øu */
        #chess-notif { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--neon); color: #000; padding: 15px 30px; border-radius: 10px; font-weight: 800; display: none; z-index: 6000; box-shadow: 0 0 30px var(--neon); text-transform: uppercase; }

        /* --- COMPONENTS --- */
        .card { background: var(--surface); border-radius: 16px; padding: 18px; margin-bottom: 15px; border: 1px solid var(--border); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .btn-neon { background: transparent; color: var(--neon); border: 1px solid var(--neon); padding: 12px 25px; border-radius: 10px; font-weight: 700; cursor: pointer; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; }
        .btn-neon:active { background: var(--neon); color: #000; }
        input { width: 100%; padding: 15px; background: #000; border: 1px solid var(--border); border-radius: 12px; margin-bottom: 12px; color: var(--neon); outline: none; }

        /* --- NAV --- */
        nav { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; background: rgba(0, 29, 61, 0.8); border-radius: 20px; padding: 15px; display: flex; justify-content: space-around; border: 1px solid var(--border); backdrop-filter: blur(10px); }
        .nav-item { font-size: 26px; color: #003566; transition: 0.3s; }
        .nav-item.active { color: var(--neon); text-shadow: 0 0 10px var(--neon); }
    </style>
</head>
<body>

<div id="splash">
    <div class="loader"></div>
    <h2 style="margin-top:20px; font-family:'Rajdhani'; letter-spacing:5px; color:var(--neon)">NEON BLUE OS</h2>
</div>

<div id="win-chess" class="win">
    <div id="chess-setup">
        <h2 style="color:var(--neon); margin-bottom:20px; font-family:'Rajdhani'">CHOOSE DIFFICULTY</h2>
        <div style="display:flex; flex-direction:column; gap:15px; width:100%">
            <button class="btn-neon" onclick="Chess.start(1)">EASY (NOOB)</button>
            <button class="btn-neon" onclick="Chess.start(2)">NORMAL (PRO)</button>
            <button class="btn-neon" onclick="Chess.start(3)">HARD (ELITE)</button>
        </div>
    </div>

    <div class="win-head">
        <div id="chess-status" style="color:var(--neon); font-weight:bold">YOUR TURN</div>
        <i class='bx bx-x' style="font-size:35px; color:var(--neon)" onclick="OS.close('chess')"></i>
    </div>
    
    <div style="padding:15px; text-align:center; position:relative;">
        <div id="chess-board"></div>
        <div id="chess-notif"></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:15px;">
            <button class="btn-neon" style="font-size:12px" onclick="Chess.undo()">UNDO</button>
            <button class="btn-neon" style="font-size:12px" onclick="location.reload()">EXIT GAME</button>
        </div>
    </div>
</div>

<div class="os-wrapper">
    <header>
        <div style="font-family:'Rajdhani'; font-size:24px; font-weight:800; color:var(--neon)">ULTI<span style="color:#fff">OS</span></div>
        <div id="u-badge" style="width:38px; height:38px; border:1px solid var(--neon); color:var(--neon); border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800;">?</div>
    </header>

    <div class="main-content">
        <div id="p-home" class="page">
            <div class="card" style="background: linear-gradient(135deg, #001d3d, #003566);">
                <h2 style="font-family:'Rajdhani'">WELCOME, <span id="u-name-hi" style="color:var(--neon)">GUEST</span></h2>
                <p style="font-size:12px; opacity:0.7">System v12: Blue Neon Environment</p>
            </div>
            
            <h4 style="margin:20px 0 10px; color:var(--neon); font-size:11px; letter-spacing:2px">SYSTEM APPS</h4>
            <div class="card" style="display:flex; align-items:center; gap:15px">
                <div style="font-size:30px">‚ôüÔ∏è</div>
                <div style="flex:1"><b>Chess Master</b><p style="font-size:11px; color:var(--neon)">AI v3.0 - Locked Turn</p></div>
                <button class="btn-neon" onclick="OS.open('chess')">PLAY</button>
            </div>
        </div>

        <div id="p-addons" class="page" style="display:none">
            <h3 style="margin-bottom:20px; color:var(--neon); font-family:'Rajdhani'">NEON ADDON STORE</h3>
            <div id="addon-list"></div>
        </div>

        <div id="p-profile" class="page" style="display:none">
            <div id="auth-box" class="card">
                <h3 style="margin-bottom:15px; color:var(--neon)">LOGIN / REGISTER</h3>
                <input id="u-in" placeholder="Username...">
                <button class="btn-neon" style="width:100%" onclick="Auth.save()">CONFIRM</button>
            </div>
            <div id="user-info" class="card" style="display:none; text-align:center">
                <h2 id="u-display" style="color:var(--neon)">Username</h2>
                <button class="btn-neon" style="margin-top:20px; border-color:#ff4d6d; color:#ff4d6d" onclick="Auth.logout()">LOGOUT</button>
            </div>
        </div>
    </div>

    <nav>
        <i class='bx bxs-home-circle nav-item active' onclick="OS.nav('home', this)"></i>
        <i class='bx bxs-layer nav-item' onclick="OS.nav('addons', this)"></i>
        <i class='bx bxs-user-detail nav-item' onclick="OS.nav('profile', this)"></i>
    </nav>
</div>

<div id="win-detail" class="win">
    <div class="win-head"><h3 style="color:var(--neon)">DETAILS</h3><i class='bx bx-x' style="font-size:35px; color:var(--neon)" onclick="OS.close('detail')"></i></div>
    <div style="padding:25px">
        <div id="det-img" style="width:100%; height:180px; background:var(--surface); border:1px solid var(--border); border-radius:15px; display:flex; align-items:center; justify-content:center; font-size:60px; margin-bottom:20px; box-shadow: 0 0 20px rgba(0,242,255,0.1)">üì¶</div>
        <h2 id="det-name" style="color:var(--neon); font-family:'Rajdhani'; margin-bottom:10px">Name</h2>
        <p id="det-desc" style="line-height:1.6; color:#8ecae6; margin-bottom:30px"></p>
        <button class="btn-neon" style="width:100%" onclick="alert('Downloading...')">DOWNLOAD ADDON</button>
    </div>
</div>

<script>
// --- CORE SYSTEM ---
const OS = {
    init() {
        setTimeout(() => document.getElementById('splash').style.display='none', 2000);
        Auth.load();
        this.renderAddons();
    },
    nav(id, el) {
        document.querySelectorAll('.page').forEach(p => p.style.display='none');
        document.getElementById('p-'+id).style.display='block';
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
    },
    open(id) { document.getElementById('win-'+id).style.display='flex'; },
    close(id) { document.getElementById('win-'+id).style.display='none'; },
    renderAddons() {
        const data = [
            {id:1, name:"Cyber Mod", icon:"‚ö°", desc:"Bi·∫øn th·∫ø gi·ªõi th√†nh t∆∞∆°ng lai v·ªõi ƒë√®n Neon v√† Robot."},
            {id:2, name:"Blue City", icon:"üèôÔ∏è", desc:"Th√†nh ph·ªë xanh bi·ªÉn v·ªõi c√°c t√≤a nh√† hi·ªán ƒë·∫°i."}
        ];
        document.getElementById('addon-list').innerHTML = data.map(a => `
            <div class="card" style="display:flex; align-items:center; gap:12px" onclick="OS.showAddon('${a.name}', '${a.desc}', '${a.icon}')">
                <div style="font-size:24px">${a.icon}</div>
                <div style="flex:1"><b>${a.name}</b></div>
                <i class='bx bx-chevron-right' style="color:var(--neon)"></i>
            </div>
        `).join('');
    },
    showAddon(n, d, i) {
        document.getElementById('det-name').innerText = n;
        document.getElementById('det-desc').innerText = d;
        document.getElementById('det-img').innerText = i;
        this.open('detail');
    }
};

// --- AUTH ---
const Auth = {
    save() {
        const u = document.getElementById('u-in').value;
        if(u) { localStorage.setItem('mc_user', u); location.reload(); }
    },
    load() {
        const u = localStorage.getItem('mc_user');
        if(u) {
            document.getElementById('auth-box').style.display='none';
            document.getElementById('user-info').style.display='block';
            document.getElementById('u-display').innerText = u;
            document.getElementById('u-name-hi').innerText = u.toUpperCase();
            document.getElementById('u-badge').innerText = u[0].toUpperCase();
        }
    },
    logout() { localStorage.removeItem('mc_user'); location.reload(); }
};

// --- CHESS ENGINE (LOCKED TURN & DIFFICULTY) ---
const Chess = {
    IMG: {'p':'https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg','P':'https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg','r':'https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg','R':'https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg','n':'https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg','N':'https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg','b':'https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg','B':'https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg','q':'https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg','Q':'https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg','k':'https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg','K':'https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg'},
    board: [], turn: 'white', selected: null, isLocked: false, history: [], level: 1,

    start(lv) {
        this.level = lv;
        document.getElementById('chess-setup').style.display = 'none';
        this.reset();
    },
    reset() {
        this.board = [['r','n','b','q','k','b','n','r'],['p','p','p','p','p','p','p','p'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['P','P','P','P','P','P','P','P'],['R','N','B','Q','K','B','N','R']];
        this.turn = 'white'; this.isLocked = false; this.history = [];
        this.msg("YOUR TURN"); this.draw();
    },
    draw() {
        const b = document.getElementById('chess-board'); b.innerHTML = '';
        let hints = this.selected ? this.getMoves(this.selected.r, this.selected.c) : [];
        for(let r=0; r<8; r++) for(let c=0; c<8; c++) {
            const d = document.createElement('div'); d.className = `cell ${(r+c)%2===0?'light':'dark'}`;
            if(this.selected?.r===r && this.selected?.c===c) d.classList.add('selected');
            if(hints.some(h => h.r===r && h.c===c)) d.classList.add('hint');
            const p = this.board[r][c];
            if(p!=='.') { const i=document.createElement('div'); i.className='piece'; i.style.backgroundImage=`url(${this.IMG[p]})`; d.appendChild(i); }
            d.onclick = () => this.click(r, c); b.appendChild(d);
        }
    },
    click(r, c) {
        if(this.isLocked || this.turn !== 'white') return; // Kh√≥a khi AI ƒëang nghƒ©
        const p = this.board[r][c];
        if(this.selected) {
            if(this.getMoves(this.selected.r, this.selected.c).some(h => h.r===r && h.c===c)) {
                this.move(this.selected.r, this.selected.c, r, c);
                this.isLocked = true; // KH√ìA NGAY L·∫¨P T·ª®C
                this.msg("AI THINKING...");
                setTimeout(() => this.ai(), 800);
            } else { this.selected = (p!=='.' && p===p.toUpperCase()) ? {r,c} : null; }
        } else if(p!=='.' && p===p.toUpperCase()) this.selected = {r,c};
        this.draw();
    },
    move(r1, c1, r2, c2) {
        this.history.push(JSON.parse(JSON.stringify(this.board)));
        const target = this.board[r2][c2];
        this.board[r2][c2] = this.board[r1][c1]; this.board[r1][c1] = '.';
        if(target.toLowerCase() === 'k') this.endGame(this.turn === 'white' ? "YOU WIN!" : "AI WIN!");
        this.turn = this.turn === 'white' ? 'black' : 'white';
    },
    ai() {
        let moves = [];
        for(let r=0; r<8; r++) for(let c=0; c<8; c++) {
            if(this.board[r][c]!=='.' && this.board[r][c]===this.board[r][c].toLowerCase()) {
                this.getMoves(r, c).forEach(m => {
                    let score = Math.random() * 10;
                    const capture = this.board[m.r][m.c];
                    if(capture !== '.') {
                        const vals = {p:10, n:30, b:30, r:50, q:90, k:900};
                        score += vals[capture.toLowerCase()] * (this.level * 2);
                    }
                    moves.push({f:{r,c}, t:m, s:score});
                });
            }
        }
        if(moves.length) {
            moves.sort((a,b) => b.s - a.s);
            const best = moves[0];
            this.move(best.f.r, best.f.c, best.t.r, best.t.c);
        }
        this.isLocked = false; // M·ªû KH√ìA SAU KHI AI ƒê√ÅNH XONG
        this.msg("YOUR TURN");
        this.draw();
    },
    getMoves(r, c) {
        let v = []; const isW = this.board[r][c] === this.board[r][c].toUpperCase();
        for(let i=0; i<8; i++) for(let j=0; j<8; j++) if(this.can(r,c,i,j,isW)) v.push({r:i, c:j});
        return v;
    },
    can(r1,c1,r2,c2,isW) {
        const p=this.board[r1][c1].toLowerCase(); const t=this.board[r2][c2];
        if(t!=='.' && (t===t.toUpperCase())===isW) return false;
        const dr=r2-r1, dc=c2-c1;
        if(p==='p') {
            const d=isW?-1:1;
            if(dc===0 && dr===d && t==='.') return true;
            if(dc===0 && dr===d*2 && t==='.' && (isW?r1===6:r1===1) && this.board[r1+d][c1]==='.') return true;
            if(Math.abs(dc)===1 && dr===d && t!=='.') return true;
            return false;
        }
        if(p==='r') return (dr===0||dc===0) && this.clear(r1,c1,r2,c2);
        if(p==='b') return Math.abs(dr)===Math.abs(dc) && this.clear(r1,c1,r2,c2);
        if(p==='n') return (Math.abs(dr)===2&&Math.abs(dc)===1)||(Math.abs(dr)===1&&Math.abs(dc)===2);
        if(p==='q') return (dr===0||dc===0||Math.abs(dr)===Math.abs(dc)) && this.clear(r1,c1,r2,c2);
        if(p==='k') return Math.abs(dr)<=1 && Math.abs(dc)<=1;
        return false;
    },
    clear(r1,c1,r2,c2) {
        const dr=Math.sign(r2-r1), dc=Math.sign(c2-c1);
        let r=r1+dr, c=c1+dc;
        while(r!==r2 || c!==c2) { if(this.board[r][c]!=='.') return false; r+=dr; c+=dc; }
        return true;
    },
    msg(t) { document.getElementById('chess-status').innerText = t; },
    endGame(t) {
        const n = document.getElementById('chess-notif');
        n.innerText = t; n.style.display = 'block';
        this.isLocked = true;
    },
    undo() { if(this.history.length && !this.isLocked) { this.board=this.history.pop(); this.draw(); } }
};

OS.init();
</script>
</body>
</html>
