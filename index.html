<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MCPE Ocean OS v25 - Final Performance</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;800&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        :root {
            --primary: #3b82f6; --bg: #020617; --surface: #0f172a;
            --text-main: #f8fafc; --text-sub: #94a3b8; --border: #1e293b;
            --tile-light: #dee3e6; --tile-dark: #8ca2ad; --tile-sel: #f59e0b99;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text-main); overflow: hidden; height: 100vh; }

        /* --- INTRO --- */
        #splash { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .bar { width: 180px; height: 4px; background: #1e293b; border-radius: 10px; overflow: hidden; margin-top: 20px; }
        .progress { width: 100%; height: 100%; background: var(--primary); animation: load 2s ease-in-out; transform-origin: left; }
        @keyframes load { from { transform: scaleX(0); } to { transform: scaleX(1); } }

        /* --- LAYOUT --- */
        .page { display: none; height: 100vh; overflow-y: auto; padding: 20px 20px 120px; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card { background: var(--surface); border: 1px solid var(--border); border-radius: 22px; padding: 20px; margin-bottom: 20px; }
        .btn { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 14px; font-weight: 800; width: 100%; cursor: pointer; font-family: 'Rajdhani'; text-transform: uppercase; }
        input { width: 100%; padding: 15px; background: #1e293b; border: 1px solid var(--border); border-radius: 12px; color: white; margin-bottom: 12px; outline: none; }

        /* --- ADDONS --- */
        .item-row { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 15px; border: 1px solid var(--border); }
        .item-img { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }

        /* --- CHESS BOARD (LOCKABLE) --- */
        #game-view { position: fixed; inset: 0; background: var(--bg); z-index: 5000; display: none; flex-direction: column; }
        #board-box { display: grid; grid-template-columns: repeat(8, 1fr); width: 95%; max-width: 400px; margin: 10px auto; aspect-ratio: 1/1; border: 6px solid #1e293b; border-radius: 10px; overflow: hidden; position: relative; }
        .board-lock { position: absolute; inset: 0; z-index: 100; display: none; } /* L·ªõp kh√≥a b√†n c·ªù */
        
        .tile { display: flex; align-items: center; justify-content: center; position: relative; }
        .tile.l { background: var(--tile-light); } .tile.d { background: var(--tile-dark); }
        .piece { width: 90%; height: 90%; background-size: contain; background-repeat: no-repeat; background-position: center; z-index: 5; }
        .sel { background: var(--tile-sel) !important; }
        .hint::after { content: ""; width: 22%; height: 22%; background: rgba(0,0,0,0.15); border-radius: 50%; }

        /* --- NAVIGATION --- */
        nav { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 450px; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(15px); border-radius: 24px; padding: 12px; display: flex; justify-content: space-around; border: 1px solid var(--border); z-index: 1000; }
        .nav-i { font-size: 26px; color: #475569; cursor: pointer; transition: 0.3s; }
        .nav-i.active { color: var(--primary); transform: translateY(-3px); }
    </style>
</head>
<body>

<div id="splash">
    <h1 style="font-family:'Rajdhani'; letter-spacing:6px;">OCEAN<span style="color:var(--primary)">OS</span></h1>
    <div class="bar"><div class="progress"></div></div>
</div>

<div id="game-view">
    <div style="padding:15px 20px; display:flex; justify-content:space-between; align-items:center;">
        <h3 style="font-family:'Rajdhani'">CHESS v25</h3>
        <i class='bx bx-x' style="font-size:35px" onclick="Game.close()"></i>
    </div>
    <div style="padding:0 15px; text-align:center;">
        <select id="level" onchange="Chess.reset()" style="width:100%; padding:12px; border-radius:12px; background:var(--surface); color:white; border:1px solid var(--border); margin-bottom:10px;">
            <option value="1">D·ªÑ</option>
            <option value="2">V·ª™A</option>
            <option value="3" selected>KH√ì</option>
        </select>
        
        <div id="board-box">
            <div id="lock-layer" class="board-lock"></div> </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <button class="btn" style="background:#475569" id="undo-btn" onclick="Chess.undo()">L√ôI B∆Ø·ªöC</button>
            <button class="btn" onclick="Chess.reset()">V√ÅN M·ªöI</button>
        </div>
        <p id="game-status" style="margin-top:20px; font-weight:800; font-family:'Rajdhani'; font-size:18px; color:var(--primary)">L∆Ø·ª¢T C·ª¶A B·∫†N</p>
    </div>
</div>

<div class="container">
    <div id="home" class="page active">
        <header style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <div style="font-family:'Rajdhani'; font-size:26px; font-weight:800;">OCEAN<span>OS</span></div>
            <div id="u-icon" style="width:40px;height:40px;background:var(--primary);border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:800">?</div>
        </header>
        <div class="card" style="background: linear-gradient(135deg, #2563eb, #020617); border:none;">
            <h2 id="hi-user">Ch√†o n√≠!</h2>
            <p style="font-size:13px; opacity:0.8; margin-top:5px;">Tr·∫°ng th√°i: ƒê√£ c·∫≠p nh·∫≠t Lock-Turn & Win Info.</p>
        </div>
        <h4 style="font-family:'Rajdhani'; color:var(--text-sub); margin-bottom:15px;">TR√í CH∆†I</h4>
        <div class="item-row" onclick="Game.open()">
            <div class="item-img" style="background: var(--primary)">‚ôüÔ∏è</div>
            <div style="flex:1"><b>Chess Master AI</b><p style="font-size:11px; color:var(--text-sub)">V25: H·ªá th·ªëng kh√≥a l∆∞·ª£t</p></div>
            <i class='bx bx-play-circle' style="font-size:30px; color:var(--primary)"></i>
        </div>
    </div>

    <div id="addons" class="page">
        <h2 style="font-family:'Rajdhani'; margin-bottom:20px;">KHO ADDONS</h2>
        <div class="item-row">
            <div class="item-img" style="background:#06b6d4">üåà</div>
            <div style="flex:1"><b>Ocean Shader v2</b><p style="font-size:11px; color:var(--text-sub)">ƒê·ªì h·ªça m∆∞·ª£t</p></div>
            <button class="btn" style="width:auto; padding:5px 15px; font-size:12px">T·∫¢I</button>
        </div>
    </div>

    <div id="profile" class="page">
        <div id="auth-ui">
            <div class="card">
                <h3 id="auth-title" style="margin-bottom:20px;">ƒêƒÇNG K√ù</h3>
                <input id="u-user" placeholder="T√™n...">
                <input id="u-pass" type="password" placeholder="M·∫≠t kh·∫©u...">
                <button class="btn" onclick="Auth.process()">X√ÅC NH·∫¨N</button>
            </div>
        </div>
        <div id="user-ui" style="display:none" class="card">
            <div style="text-align:center">
                <div id="av-big" style="width:80px;height:80px;background:var(--primary);border-radius:20px;margin:0 auto 15px;display:flex;align-items:center;justify-content:center;font-size:35px;font-weight:800">?</div>
                <h2 id="nm-big">User</h2>
                <button class="btn" style="background:#ef4444; margin-top:25px;" onclick="Auth.logout()">ƒêƒÇNG XU·∫§T</button>
            </div>
        </div>
    </div>
</div>

<nav>
    <i class='bx bxs-home-alt-2 nav-i active' onclick="Tab('home', this)"></i>
    <i class='bx bxs-component nav-i' onclick="Tab('addons', this)"></i>
    <i class='bx bxs-user-circle nav-i' onclick="Tab('profile', this)"></i>
</nav>

<script>
// --- CORE ---
const Auth = {
    data: JSON.parse(localStorage.getItem('ocean_v25')),
    process() {
        const u = document.getElementById('u-user').value, p = document.getElementById('u-pass').value;
        if(u && p) { localStorage.setItem('ocean_v25', JSON.stringify({u,p})); location.reload(); }
    },
    logout() { localStorage.removeItem('ocean_v25'); location.reload(); },
    init() {
        setTimeout(() => document.getElementById('splash').style.display='none', 2000);
        if(this.data) {
            document.getElementById('auth-ui').style.display='none';
            document.getElementById('user-ui').style.display='block';
            document.getElementById('hi-user').innerText = "Ch√†o, " + this.data.u;
            document.getElementById('nm-big').innerText = this.data.u;
            document.getElementById('u-icon').innerText = this.data.u[0].toUpperCase();
            document.getElementById('av-big').innerText = this.data.u[0].toUpperCase();
        }
    }
};

// --- CHESS v25 (FULL LOGIC) ---
const Chess = {
    IMG: { 'p': 'https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg', 'P': 'https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg', 'r': 'https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg', 'R': 'https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg', 'n': 'https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg', 'N': 'https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg', 'b': 'https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg', 'B': 'https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg', 'q': 'https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg', 'Q': 'https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg', 'k': 'https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg', 'K': 'https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg' },
    board: [], turn: 'W', sel: null, history: [], gameOver: false,

    reset() {
        this.board = [['r','n','b','q','k','b','n','r'],['p','p','p','p','p','p','p','p'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['.','.','.','.','.','.','.','.'],['P','P','P','P','P','P','P','P'],['R','N','B','Q','K','B','N','R']];
        this.turn = 'W'; this.sel = null; this.history = []; this.gameOver = false;
        this.unlockBoard(); this.draw();
        document.getElementById('game-status').innerText = "L∆Ø·ª¢T C·ª¶A B·∫†N";
        document.getElementById('game-status').style.color = "var(--primary)";
    },
    draw() {
        const box = document.getElementById('board-box'); 
        const tiles = box.querySelectorAll('.tile');
        if(tiles.length === 0) { // T·∫°o b√†n l·∫ßn ƒë·∫ßu
            for(let r=0; r<8; r++) for(let c=0; c<8; c++) {
                const t = document.createElement('div'); t.className = `tile ${(r+c)%2===0?'l':'d'}`;
                t.onclick = () => this.click(r, c); box.appendChild(t);
            }
        }
        const currentTiles = box.querySelectorAll('.tile');
        let moves = this.sel ? this.getMoves(this.sel.r, this.sel.c) : [];
        currentTiles.forEach((tile, i) => {
            let r = Math.floor(i/8), c = i%8;
            tile.innerHTML = ''; tile.className = `tile ${(r+c)%2===0?'l':'d'}`;
            if(this.sel?.r===r && this.sel?.c===c) tile.classList.add('sel');
            if(moves.some(m => m.r===r && m.c===c)) tile.classList.add('hint');
            const p = this.board[r][c];
            if(p !== '.') {
                const img = document.createElement('div'); img.className='piece';
                img.style.backgroundImage=`url(${this.IMG[p]})`; tile.appendChild(img);
            }
        });
    },
    lockBoard() { document.getElementById('lock-layer').style.display = 'block'; },
    unlockBoard() { document.getElementById('lock-layer').style.display = 'none'; },

    click(r, c) {
        if(this.turn !== 'W' || this.gameOver) return;
        const p = this.board[r][c];
        if(this.sel) {
            if(this.getMoves(this.sel.r, this.sel.c).some(m => m.r===r && m.c===c)) {
                this.execute(this.sel.r, this.sel.c, r, c);
                if(!this.gameOver) {
                    this.lockBoard(); // Kh√≥a b√†n c·ªù ngay l·∫≠p t·ª©c
                    document.getElementById('game-status').innerText = "AI ƒêANG ƒêI...";
                    setTimeout(() => this.ai(), 600);
                }
            } else this.sel = (p !== '.' && p === p.toUpperCase()) ? {r,c} : null;
        } else if(p !== '.' && p === p.toUpperCase()) this.sel = {r,c};
        this.draw();
    },
    execute(r1, c1, r2, c2) {
        this.history.push(JSON.stringify(this.board));
        const target = this.board[r2][c2];
        if(target.toLowerCase() === 'k') {
            this.gameOver = true;
            const win = this.turn === 'W';
            document.getElementById('game-status').innerText = win ? "B·∫†N TH·∫ÆNG!" : "B·∫†N THUA!";
            document.getElementById('game-status').style.color = win ? "#10b981" : "#ef4444";
            this.lockBoard();
        }
        this.board[r2][c2] = this.board[r1][c1]; this.board[r1][c1] = '.';
        this.turn = this.turn === 'W' ? 'B' : 'W'; this.sel = null;
    },
    ai() {
        if(this.gameOver) return;
        const lv = document.getElementById('level').value;
        let moves = [];
        for(let r=0; r<8; r++) for(let c=0; c<8; c++) {
            if(this.board[r][c] !== '.' && this.board[r][c] === this.board[r][c].toLowerCase()) {
                this.getMoves(r, c).forEach(m => {
                    let s = Math.random() * 5;
                    if(this.board[m.r][m.c] !== '.') s += 50; 
                    if(lv=="3" && m.r>2 && m.r<5 && m.c>2 && m.c<5) s += 5;
                    moves.push({f:{r,c}, t:m, s:s});
                });
            }
        }
        if(moves.length > 0) {
            moves.sort((a,b) => b.s - a.s);
            let m = (lv == "1") ? moves[Math.floor(Math.random()*moves.length)] : moves[0];
            this.execute(m.f.r, m.f.c, m.t.r, m.t.c);
        }
        if(!this.gameOver) {
            this.unlockBoard(); // M·ªü kh√≥a sau khi AI ƒëi xong
            document.getElementById('game-status').innerText = "L∆Ø·ª¢T C·ª¶A B·∫†N";
        }
        this.draw();
    },
    getMoves(r, c) {
        let ms = []; for(let i=0; i<8; i++) for(let j=0; j<8; j++) if(this.can(r, c, i, j)) ms.push({r:i, c:j});
        return ms;
    },
    can(r1, c1, r2, c2) {
        const p = this.board[r1][c1].toLowerCase(), t = this.board[r2][c2], isW = this.board[r1][c1] === this.board[r1][c1].toUpperCase();
        if(t !== '.' && (t === t.toUpperCase()) === isW) return false;
        const dr = r2-r1, dc = c2-c1;
        if(p === 'p') {
            const d = isW ? -1 : 1;
            if(dc === 0 && dr === d && t === '.') return true;
            if(dc === 0 && dr === d*2 && t === '.' && (isW?r1===6:r1===1)) return this.board[r1+d][c1] === '.';
            return Math.abs(dc) === 1 && dr === d && t !== '.';
        }
        if(p === 'r') return (dr === 0 || dc === 0) && this.clear(r1,c1,r2,c2);
        if(p === 'b') return Math.abs(dr) === Math.abs(dc) && this.clear(r1,c1,r2,c2);
        if(p === 'q') return (dr === 0 || dc === 0 || Math.abs(dr) === Math.abs(dc)) && this.clear(r1,c1,r2,c2);
        if(p === 'n') return (Math.abs(dr)===2 && Math.abs(dc)===1) || (Math.abs(dr)===1 && Math.abs(dc)===2);
        if(p === 'k') return Math.abs(dr) <= 1 && Math.abs(dc) <= 1;
        return false;
    },
    clear(r1, c1, r2, c2) {
        let dr = Math.sign(r2-r1), dc = Math.sign(c2-c1), r = r1+dr, c = c1+dc;
        while(r !== r2 || c !== c2) { if(this.board[r][c] !== '.') return false; r += dr; c += dc; }
        return true;
    },
    undo() { if(this.history.length > 0 && !this.gameOver) { this.board = JSON.parse(this.history.pop()); this.turn = 'W'; this.draw(); } }
};

function Tab(id, el) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.nav-i').forEach(i => i.classList.remove('active'));
    el.classList.add('active');
}
const Game = { open() { document.getElementById('game-view').style.display='flex'; Chess.reset(); }, close() { document.getElementById('game-view').style.display='none'; } };
Auth.init();
</script>
</body>
</html>
